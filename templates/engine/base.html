{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="{% static "engine/css/style.css" %}">
</head>
<script type="text/javascript">
    function AjaxGetCity(city){
        $.ajax({
            url: "{% url 'get_temp_for_current_city' %}",
            type: 'POST',
            data: {
                csrfmiddlewaretoken: '{{ csrf_token }}',
				city: city
            },
            success: function(html){
                $("#text").html(html);
            }
        });
    }
    function AjaxRemoveCity(pk){
        $.ajax({
            url: "{% url 'remove_city' %}",
            data: {
				pk: pk
            }
        });
    }
</script>
<style>
.textInput{border:1px solid rgba(0,0,0,.15);padding:0 5px;height:35px;font-size:14px;outline:0;background:rgba(221, 221, 221, 0);-webkit-appearance:none;-moz-appearance:none;appearance:none;box-sizing:border-box;border-radius:4px;letter-spacing:0;font-weight:400;font-style:normal}.textInputLabel{display:table-cell;vertical-align:middle;height:35px;font-size:14px;box-sizing:border-box;letter-spacing:0;font-style:normal}.textInput:invalid{box-shadow:none}.textInput--textarea{padding:15px;margin:15px 0 30px;resize:none;width:100%;height:50px;overflow:hidden}.textInput--textarea:focus{outline:0}.textInput--fullWidth{width:100%}.textInput--narrow{width:255px}.textInput--width50{width:50px}.textInput--large{font-size:18px;height:40px;margin:10px auto;overflow:hidden;padding:7px;width:500px;white-space:nowrap;letter-spacing:0;font-weight:300;font-style:normal}.textInput--jumbo{letter-spacing:0;font-weight:300;font-style:normal;font-size:50px;height:80px;padding:0;width:100%}.textInput--transparent{background:0 0}@media all and (max-width:767px){.textInput--jumbo{font-size:32px;height:50px}.textInput--narrow{width:175px;height:32px;padding:0 10px}}.textInput--rounded{border-radius:999em}.textInput--transparent{background:0 0}.textInput--darkText{color:rgba(0,0,0,.8)}.textInput--chromeless{border:0;padding:0;outline:0;height:auto;background:0 0}.textInput--underlined{border:0;border-bottom:1px solid rgba(0,0,0,.15);border-radius:0}.inputGroup{position:relative}.inputGroup .textInput:not(.textInput--narrow){width:100%;box-sizing:border-box}.inputGroup--text{text-align:left;width:100%;margin-bottom:10px}.inputGroup--text>.inputGroup-title{color:rgba(0,0,0,.44);font-size:14px}.inputGroup--text>.textInput{margin:0}.inputGroup-description{margin-top:15px;margin-bottom:25px;font-size:16px;color:rgba(0,0,0,.44)}.label--radio .inputGroup-description{margin-left:30px}.inputGroup .svgIcon{top:-1px;position:relative}.metabar .inputGroup.inputGroup--selection{margin-top:15px;margin-bottom:10px;text-align:left}.inputGroup--selection .inputGroup-description{position:relative;margin-left:30px;margin-bottom:15px;font-size:12px;color:rgba(0,0,0,.6)}.inputGroup--selection .inputGroup-description--last{margin-bottom:0}.inputGroup--selection .button--small{margin-top:10px}.inputGroup--error>.textInput{border-color:#cc5454}.inputGroup--error>.inputGroup-title{color:#cc5454}.inputGroup--success>.textInput{border-color:rgba(0,0,0,.15)}
</style>

<body>
<div class="wrapper">
  <div class="text-wrap">
    <div class="text" id="text">Now in {{ last_city }} is {{ last_weather.temp }} C and {{ last_weather.text }}<br><br><br><br><br>
      {% for forecast in forecasts %}
          {{ forecast.date }} will be {{ forecast.text }} (high {{ forecast.high }} C, low {{ forecast.low }} C)<br>
      {% endfor %}
    </div>
  </div>
  <div class="header">
      <div class="burger-wrapper">
          <div class="burger"></div>
      </div>
      <div class="logo-text">Cities</div>
  </div>
    <div class="nav">
        <ul class="nav_main" id="nav_main">
        <form method="POST" class="search-form" id="search" style="width:100%">{% csrf_token %}
            <input class="js-searchInput textInput textInput--jumbo textInput--underlined u-marginBottom40" type="search" id="searchText" placeholder="ENTER CITY" maxlength="300" style="text-align: center;font-size: 2rem;padding-bottom: -100px; color:#111">
        </form>
            {% include "engine/city_list.html" %}
        </ul>
    </div>
    <div class="mini-player">
        <div class="track_info_wrapper">
            <div class="track_info" id="miniplayer">
                <div class="info" id="location_weather">

                </div>
            </div>
        </div>
        <div class="mini-player_btn_wrapper"><i class="btn-prev fa fa-step-backward" aria-hidden="true"></i>
            <div class="btn-switch"><i class="btn-play fa fa-play" aria-hidden="true"></i><i class="btn-pause fa fa-pause" aria-hidden="true"></i></div><i class="btn-next fa fa-step-forward" aria-hidden="true"></i><i class="btn-open-player fa fa-list" aria-hidden="true"></i>
        </div>
    </div>
    <div class="dim"></div>
</div>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.0/TweenMax.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.0/TimelineMax.min.js'></script>
<script src="{% static "engine/js/index.js" %}"></script>
<script>
    navigator.geolocation.getCurrentPosition(function(location) {
      $.ajax({
                url: "{% url 'location_weather' %}",
                type: 'POST',
                data: {
                    csrfmiddlewaretoken: '{{ csrf_token }}',
                    latitude: location.coords.latitude,
                    longitude: location.coords.longitude
                },
                success: function(html){
                    $("#location_weather").html(html);
                    var city = $('#location_weather_city').attr('data');
                    $('#current_city').html(city + " (your location)");
                }
            });
        });

    $(document).ready(function(){
        $("#search").submit(function(event){
          event.preventDefault();
          var searchText = document.getElementById('searchText').value;
          AjaxGetCity(searchText);
        });
    });
</script>
</body>
</html>
